% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SAEnet.R
\name{saenet}
\alias{saenet}
\title{Structure-Adaptive Elastic Net}
\usage{
saenet(
  formula,
  data,
  x,
  y,
  structure_info,
  max_iterations = 5,
  standardize = TRUE,
  alpha_sequence = seq(0, 1, by = 0.1),
  nlambda = 100,
  lambda_min_ratio = ifelse(nobs < nvars, 0.01, 1e-04),
  gamma_sequence = seq(0.1, 1, by = 0.1),
  num_folds = 10,
  num_cores = 1,
  verbose = TRUE
)
}
\arguments{
\item{formula}{An object of class formula: a symbolic description of the model to be fitted}

\item{data}{A data frame containing the variables in the model}

\item{x}{Design matrix of predictors (n Ã— p) (alternative to formula/data)}

\item{y}{Response vector (alternative to formula/data)}

\item{structure_info}{External structural information. Can be:
\itemize{
  \item NULL: No structural information (standard adaptive elastic net)
  \item List with `group`: Group-based structural info with `$group` component
        indicating group membership
  \item List with `covariate`: Covariate-dependent structural info with `$covariate`
        component containing covariate values
}}

\item{max_iterations}{Number of iterations for the adaptive penalty procedure (default: 5)}

\item{standardize}{Logical. Whether to standardize the predictors (default: TRUE)}

\item{alpha_sequence}{A sequence of elastic net mixing parameters (0 <= alpha <= 1) to try,
where alpha=1 is lasso and alpha=0 is ridge (default: seq(0, 1, by = 0.1))}

\item{nlambda}{Number of lambda values to generate in the sequence (default: 100)}

\item{lambda_min_ratio}{Ratio of smallest to largest lambda value in the sequence
(default: 1e-4 for n >= p, 0.01 for n < p)}

\item{gamma_sequence}{A sequence of power parameters for adaptive weights
(default: seq(0.1, 1, by = 0.1))}

\item{num_folds}{Number of folds for cross-validation (default: 10)}

\item{num_cores}{Number of cores for parallel computation (default: 1)}

\item{verbose}{Logical. Whether to print progress messages (default: TRUE)}
}
\value{
An object of class "saenet" with the following components:
  \itemize{
    \item intercept: Vector of estimated intercept values for each iteration
    \item coefficients: Matrix of estimated coefficient vectors (on original scale)
         with columns corresponding to iterations
    \item weights: Matrix of adaptive weights for each iteration
    \item cv_errors: Vector of cross-validation errors for each iteration
    \item lambda: Vector of selected lambda parameters for each iteration
    \item alpha: Vector of selected alpha parameters for each iteration
    \item gamma: Vector of selected gamma parameters for each iteration
    \item num_iterations: Number of iterations performed
    \item feature_scaling: Scaling information for predictors (if standardize=TRUE)
  }
}
\description{
Implements the Structure-Adaptive Elastic Net (SAEnet) method, which extends
the elastic net framework by incorporating external structural information.
This approach translates external information about predictors into different
penalization strengths for the regression coefficients.
}
\details{
The Structure-Adaptive Elastic Net incorporates external structural information
to improve variable selection in high-dimensional regression. The method adapts
the standard elastic net by allowing the adaptive weights to depend on external
structural information, which can be either group-based or covariate-dependent.

The algorithm follows an iterative procedure:
1. Initialize by fitting a standard elastic net
2. Generate adaptive weights based on the structural information
3. Solve the weighted elastic net problem
4. Repeat steps 2-3 for a specified number of iterations
}
\examples{
# Example 1: Standard Adaptive Elastic Net (No Structure)
set.seed(123)
n <- 100  # number of observations
p <- 200  # number of variables
X <- matrix(rnorm(n * p), n, p)
beta_true <- c(rep(1, 10), rep(0, p - 10))
y <- X \%*\% beta_true + rnorm(n, 0, 0.5)

# Fit the model
fit <- saenet(y = y, x = X, max_iterations = 3, num_folds = 5)

# View model summary
print(fit)

# Extract coefficients from the final iteration
beta_est <- predict(fit, type = "coefficients")

# Make predictions for new data
predictions <- predict(fit, newx = X)

# Plot non-zero coefficients
plot(fit, type = "coefficients")

# Plot CV error across iterations
plot(fit, type = "cv.error")

# Example 2: Group-based Structure
# Create arbitrary groups for variables (10 groups of 20 variables each)
groups <- rep(1:10, each = 20)
structure_info <- list(group = groups)

# Fit the model with group structure
fit_group <- saenet(y = y, x = X, structure_info = structure_info,
                    max_iterations = 3, num_folds = 5)

# Plot non-zero coefficients
plot(fit_group, type = "coefficients")

# Example 3: Covariate-dependent Structure
# Create arbitrary covariate related to variable importance
# (higher values for more important variables)
covariate <- runif(p)
covariate[1:10] <- covariate[1:10] + 0.5  # make important variables have higher values
structure_info <- list(covariate = matrix(covariate, ncol = 1))

# Fit the model with covariate structure
fit_covariate <- saenet(y = y, x = X, structure_info = structure_info,
                        max_iterations = 3, num_folds = 5)

# Plot non-zero coefficients
plot(fit_covariate, type = "coefficients")

}
\references{
Pramanik, S., & Zhang, X. (2020). Structure Adaptive Elastic-Net. arXiv:2006.02041.
}
